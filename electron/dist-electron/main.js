"use strict";const e=require("electron"),s=require("node:path"),_=require("sqlite3"),p=s.join(__dirname,".."),d=s.join(p,"dist-electron"),w=s.join(p,".output/public"),h=process.env.VITE_DEV_SERVER_URL?s.join(p,"public"):w;function u(){const i={width:1920,height:1080,center:!0,autoHideMenuBar:!0,webPreferences:{preload:s.join(d,"preload.js"),webSecurity:!1,allowRunningInsecureContent:!0}},n=new e.BrowserWindow(i),t=process.env.VITE_DEV_SERVER_URL||s.join(h,"index.html");n.loadURL(t)}async function E(){return(await e.dialog.showOpenDialog({properties:["openDirectory"]})).filePaths}function R(i){e.shell.openExternal(i)}function b(i,n,t=[]){const a=new _.Database("tags.db");return new Promise((f,c)=>{const r=(l,o)=>{l?c(l):f(o)};switch(i){case"run":a.run(n,t,function(o){r(o,{id:this.lastID,changes:this.changes})});break;case"get":a.get(n,t,r);break;case"each":console.log("Verifying insertion for:",n);const l=[];a.each(n,(o,g)=>{o?c(o):l.push(g)},o=>{o?c(o):r(null,l)});break;case"all":a.all(n,t,r);break;default:c(new Error("Unknown action"))}a.close()})}function D(){e.ipcMain.handle("app-open-file-dialog",E),e.ipcMain.handle("app-open-url",(i,n)=>R(n)),e.ipcMain.handle("sqlite-operations",(i,n,t,a)=>b(n,t,a))}function I(){e.app.on("window-all-closed",()=>{process.platform!=="darwin"&&e.app.quit()}),e.app.whenReady().then(()=>{D(),u(),e.app.on("activate",()=>{e.BrowserWindow.getAllWindows().length===0&&u()})}),console.log("App initialized"),console.log("App root:",p),console.log("Main dist:",d),console.log("Renderer dist:",w),console.log("Vite public:",h),console.log("App Data:",e.app.getPath("userData"))}I();
